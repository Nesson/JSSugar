var parseExpressionToObject=function(a){if(!a){return null}var g=new Object();var e=/^(required\s*:\s*(true|false)?\s*(,)?)?/i,i=/(validType\s*:\s*(.*))$/i;var c=e.exec(a);g.required=c?c[2]==="true":false;var b=i.exec(a);var d=b?b[2]:null;d=d?d.replace(/(^{|}$|\s)/g,""):null;var h=!d?null:d.split(/&&|&/),f=new Array();if(h){$.each(h,function(j,k){f[j]=k})}g.validType=f;return g};if(!String.prototype.format){String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})}}if(!String.prototype.trim){String.prototype.trim=function trim(){return this.toString().replace(/^([\s]*)|([\s]*)$/g,"")}}var fieldIsBlank=function(a){return $(a).val().trim().length===0?true:false};var execValidation=function(a,c){var b=$(a).val().replace(/[\n\r]/g,"");if(typeof(c)!="function"){return c.test(b)}return c(b)};var showErrorMessage=function(c,a){var b=$(c).next("label");if(!b.html()){b=$("<label class='sugar_validation_error_message' style='color:red'>{0}</label>".format(a))}else{b.html(a)}b.insertAfter(c)};var removeErrorMessage=function(a){$(a).next("label").remove()};var markOnField=function(a){var b=$(a);b.attr("ori-border-color",b.css("border-color"));b.attr("ori-background-color",b.css("background-color"));b.css("border-color","#DC322F").css("background-color","#FEE6E7");var c=b.attr("invalidMessage")==undefined?"Filed is not validated!":b.attr("invalidMessage");showErrorMessage(a,c);return true};var markOffField=function(a){var b=$(a);(b.attr("ori-border-color")!=undefined)&&b.css("border-color",b.attr("ori-border-color"));(b.attr("ori-background-color")!=undefined)&&b.css("background-color",b.attr("ori-background-color"));removeErrorMessage(a);return true};var regexs={"undefined":false,number:/^\d*$/,email:/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,url:/^(ht|f)tps?:\/\/[a-z0-9-\.]+\.[a-z]{2,4}\/?([^\s<>\#%"\,\{\}\\|\\\^\[\]`]+)?$/};var regexs2={length:function(a){return a.length!=1?new RegExp("^.{{0},{1}}$".format(a[0],a[1])):new RegExp("^.{0,{0}}$".format(a[0]))},minNum:function(a){return function(b){return !$.isNumeric(b)?false:a[0]<=parseFloat(b)}},maxNum:function(a){return function(b){return !$.isNumeric(b)?false:a[0]>=parseFloat(b)}},equals:function(a){return function(c){var b=$("{0}".format(a[0])).val();return c===b}},regex:function(a){return new RegExp(a[0])}};var getRestriction=function(d){var b=regexs[d];if(b){return b}var c=/(^.+)(\[.+]$)/i.exec(d);var e=c[1];var a=c[2].replace(/^\[(.+)]$/i,"$1").split(",");return regexs2[e](a)};var validationFun=function(b){var e=$(b).find("input[exp], select[exp], textarea[exp]");var a=new Array(),d=0;e.each(function(f,g){var h=parseExpressionToObject($(g).attr("exp"));if(!h){return}(h.required&&!fieldIsBlank(g)&&markOffField(g)&&((a[d]=1)||true))||(h.required&&markOnField(g)&&((a[d]=0)||true))||(a[d]=1);if(a[d++]){$.each(h.validType,function(i,j){var k=getRestriction(j);(execValidation(g,k)&&markOffField(g)&&((a[d]=1)||true))||(markOnField(g)&&(a[d]=0));d++})}});var c=/(0(,)?)+/.test(a.toString());return !c};$(document).ready(function(){$("form:not([vOFF], [validationOFF], [validation=off])").each(function(){$(this).submit(function(){return validationFun(this)})})});